CREATE TABLE tovornjak (
  registrska TEXT PRIMARY KEY,
  nosilnost INTEGER NOT NULL,
  datum_rojstva DATE NOT NULL,
  ime TEXT NOT NULL,
  priimek TEXT NOT NULL
);

CREATE TABLE prevoz (
  id SERIAL PRIMARY KEY,
  datum DATE NOT NULL,
  kolicina INTEGER,
  cena_tone INTEGER,
  zacetek TEXT REFERENCES mesta(ime),
  konec TEXT REFERENCES mesta(ime)
);

CREATE TABLE mesta (
  ime TEXT,
  razdalja INTEGER, 
  PRIMARY KEY(ime,razdalja)
);

CREATE TABLE mesecni_stroski (
  registrska TEXT REFERENCES tovornjak(registrska),
  mesec TEXT,
  gorivo INTEGER,
  popravilo INTEGER,
  PRIMARY KEY(registrska, mesec)
);

CREATE TABLE cestnina (
  registrska TEXT REFERENCES tovornjak(registrska),
  mesec TEXT REFERENCES mesecni_stroski(mesec),
  italija INTEGER CHECK(italija >= 0) DEFAULT 0,
  slovenija INTEGER CHECK(slovenija >= 0) DEFAULT 0,
  madzarska INTEGER CHECK(madzarska >= 0) DEFAULT 0,
  hrvaska INTEGER CHECK(hrvaska >= 0) DEFAULT 0,
  avstrija INTEGER CHECK(avstrija >= 0) DEFAULT 0,
  PRIMARY KEY(registrska, mesec)
);

CREATE VIEW cestnina_na_mesec
AS SELECT SUM(italija), SUM(slovenija), SUM(madzarska), SUM(hrvaska), SUM(avstrija)
FROM cestnina GROUP BY mesec
;

CREATE VIEW stroski_na_mesec
AS SELECT SUM(gorivo) AS gorivo_na_mesec, SUM(cestnina_na_mesec) AS cestnina_na_mesec
FROM mesecni_stroski JOIN cestnina_na_mesec;
--Kako bi naredile, da view mesecni stroski že sešteje vse cestnine?










